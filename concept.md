# Пинбол #

* [Геймплей](#gameplay)
    * [Бамперы](#bumpers)
    * [Флаги](#flags)
    * [Трамплин](#kicker)
    * [Пылесос](#vacuum)
	* [Ротатор](#rotator)
* [Очки](#points)
    * [За время](#points_for_time)
    * [За бамперы](#points_for_bumpers)
    * [За флаги](#points_for_flags)
    * [За замедление](#points_for_slowtime)
* [Окружение и атмосфера](#around)
* [Кат-сцены](#cuts)
    * [Финальная](#cut_final)
* [Звуки](#sounds)
* [GUI](#gui)
* [Экраны](#screens)
* [Баги](#bugs)
* [Таски и сниппеты](#tasks)

Итак, это будет пинбол.

Разработка под PC, Android & iOS, соответственно надо помнить, что

1.  Помимо клавиатурного ввода для каждого действия нужны тач-панели,
2.  Мощность целевых платформ ограничена.


<h2 id="gameplay">Геймплей</h2>

Перед нами наклоненный стол с невысокими стенками и накрытый стеклом, по нему носится шарик. Снизу стола дырка, через которую шарик может вылететь. Верхние углы стола изнутри скруглены. Внутри пара прямых и кривых стен и много чего еще (см. [концепт.жпг](concept_20140222.png)).

Справа расположена классическая шахта для запуска шариков, запускаются по `Space` (на мобильных платформах - тыкать прямо на шахту), чем дольше держишь - тем сильнее сила запуска. Запускать шарики можно один за одним - хоть все сразу. На выходе из шахты - клапан, который пропускает шарики только наружу. В наличии три-пять шариков.

Флипперы расположены вокруг нижней дырки (2 штуки), один сверху и еще один посередине - под управление `WASD`. На планшетах и телефонах - тач-круги два справа и два слева.
Нижние флипперы работают по принципу "активны пока клавиша зажата".
Снизу и сверху вращающегося обруча расположены флипперы, работающие по `W` и `S`, и в неактивном состоянии убирающиеся под стол. Когда пользователь активирует флиппер, он вылезает из стола на фиксированное время (~ полсекунды) и  потом прячется обратно. Повторно использовать флиппер можно после таймаута в полсекунды.

Стол можно бить руками слева и справа - клавиши `Q` и `E`, для мобильных устройств - тряска планшета/телефона влево/вправо (тут работа с акселерометром). У кого нет ни клавиатуры, ни акселерометра стол не потрясет.

Замедление времени - удержанием `Shift`, на мобильных устройствах - тач-область посередине снизу работающая по принципу "нажал - включил, нажал еще раз - выключил". При включенном замедлении счет начинает уменьшается на 1/30 текущего счета в секунду, минимально возможный счет - 0.

<h3 id="bumpers">Бамперы</h3>

Изначально стол без бамперов (цилиндров, которые отбрасывают шарик при столкновении). После старта они вылезают по своим таймерам, делая игру более стремительной.

Каждый бампер имеет тауймаут, т.е. после столкновения он две секунды имеет физику обычного цилиндра. Это состояние назовем активированным. По прошествии таймаута бампер переходит в не активированное состояние и вновь может долбить шарики с безумной силой.

<h3 id="flags">Флаги</h3>

На столе присутствуют флаги, расположенные у стен. Флаги не имеют физической модели. Когда шарик пролетает сквозь флаг, то флаг активируется.

Когда будут активированы все флаги на столе, то состояние флагов сбросится, а игрок получит бонус к очкам и включится бесплатное замедление времени на 2 секунды.

<h3 id="kicker">Трамплин (под вопросом)</h3>

В конце по таймеру в центре вылезает трамплин. Если шарик залетает на него под небольшим углом и с достаточной скоростью, то шарик пробивает насквозь стекло стола и летит прямо в камеру, включается замедление времени. Осколки стекла разлетаются в стороны. Когда шарик долетает до камеры экран краснеет и выводится капсом текст “You died and won”, показывается счет и время.

Если у шарика скорость недостаточна высока или угол залета на трамплин слишком большой - на стекло в месте удара вешается декаль трещин.

<h3 id="vacuum">Пылесос</h3>

2 дырки в столе - в одну шарик засасывает, из другой через 2 секунды выплевывает в сторону игрока, ударяя об стекло. На стекле оставляется декаль трещин с высокой прозрачностью, степень прозрачности уменьшается с каждым ударом (визуально будет увеличиваться трещина на стекле).
Радиус действия пылесоса больше размера дырки, поэтому шарик может изменить траекторию пролетая мимо. Выталкивающая дырка также действует на шарик если он вблизи, отталкивая его от себя. Силы засасывания/отталкивания обратно пропорциональны квадрату расстояния.

<h3 id="rotator">Ротатор</h3>

В середине стола расположен вращающийся с маленькой скоростью обруч, по периметру которого расположено несколько стен (см. [концепт.жпг](concept_20140222.png)). В центре обруча расположен бампер.

<h2 id="points">Очки</h2>

<h3 id="points_for_time">За время</h3>

В единицу времени начисляется по T очков, где T - текущее время игры в секундах.

Если на поле к примеру 3 шарика - то очков в секунду начисляется в 3! (факториал, 3! = 6) раза больше, чем если бы на поле был только один шарик.

<h3 id="points_for_bumpers">За активацию бамперов</h3>

Чем больше бамперов на момент удара активировано - тем больше очков дается (допустим, умножаем на число активных бамперов).

Если в какой-то момент времени будут активированы все бамперы - дается супер-мега-аццкий бонус в 100500 очков

<h3 id="points_for_flags">За флаги</h3>

За активацию всех флагов давать небольшой бонус.

<h3 id="points_for_slowtime">За замедление времени</h3>

Очки списываются за каждые миллисекунды замедления.


<h2 id="around">Окружение и атмосфера</h2>

Игровой стол плоский, без столба сзади который свойственен аркадным автоматам.

Стоит стол в сталелитейном цеху, смена как раз закончилась и здоровые русские мужики идут домой.

Стол сделал по-советски - из неструганного дерева и почти без скруглений. Стоит на наклонной (7 градусов) подставке (подставка совсем на полу). На элементах стола символика СССР - красные звезды, серп и молот.

Мужики-трудяги охотно ставят на стол бутылку водки, кладут огурчик, обсуждают будни. 

<h2 id="cuts">Кат-сцены</h2>

<h3 id="cut_final">Финальная</h3>

После вылета шарика в лицо игрока показывается ч/б/к (черный, белый, красный) слегка анимированная картинка в плоской рисовке. На ней показан вид сбоку вдоль береговой линии и изображены стол, пальма, игрок и шарик, который пролетает сквозь голову игрока, уносся с собой кровавый фонтан.

<h2 id="sounds">Звуки</h2>

Необходим следующий набор звуков:

* 1 на натяжку пружины, которая запускает шарик в шахте
* 1 на распрямление пружины, которая запускает шарик в шахте
* 2 на столкновение шарика со стенами
* 2 на активацию бампера
* 1 на деактивацию бампера
* 1 на активацию флага
* 1 на бонус активации всех бамперов разом
* 1 на активацию всех флагов
* 1 на вылет шарика за пределы стола
* 1 на проигрыш
* 1 на трескающееся стекло
* 1 на бьющееся стекло
* Фоновая музыка - что-то из совесткого и тихое. Возможно, телевизионную передачу пустить. Или Высоцкого о_О.
* При замедлении времени звучание должно плавно меняться (замедление + для сохранения нормального звучания должен меняться pitch, кажется).

Если разных, _но похожих_ звуков на одно действие будет больше - это только на пользу.


<h2 id="gui">GUI</h2>

В левом верхнем углу отображать текущий счет, в правом верхнем - время игры.


<h2 id="screens">Экраны</h2>

* Стартовый экран (или совместить с игровым?)
* Игра
* Хайскор


<h2 id="bugs">Баги</h2>

* В текущей реализации управления флиппером можно поймать шарик и держать его сколь угодно долго, накапливая очки за время.

<h2 id="tasks">Таски и сниппеты</h2>

* Шарики пролетают сквозь флипперы
* Намоделить флаги и написать к ним скрипт
* Намоделить дырки пылесоса и написать у нему скрипт
* Намоделить ротатор и опять же заскриптовать
* Дубликатор шариков
* Скрипт ведения счета, привязать с замедлялке времени
* Скрипт для создания трещин на стекле
* Реализовать переворот стола
